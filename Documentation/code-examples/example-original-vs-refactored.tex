\begin{figure}[h]
\begin{minipage}{0.45\textwidth}
\begin{sourcecode}
\begin{javacode}{2,6}
public abstract class DocumentLoader 
	extends SwingWorker<List<Document>, Document> {
    ...
    public void load(File... files) {
        this.files = files;
        execute();
    }

    protected List<Document> doInBackground() 
    	throws Exception {
        ...
        publish(new Document(...
        ...
    }

    protected void process(List<Document> chunks){
        fetchResult( chunks );
    }
    ...
\end{javacode}
\caption{DocumentLoader - Modified Code}
\label{code:example-original}
\end{sourcecode}
\end{minipage}\hspace{0.7cm}
\begin{minipage}{0.51\textwidth}
\begin{sourcecode}
\begin{javacode}{2,6,9-12,19}
public abstract class DocumentLoader 
	extends SWSubscriber<List<Document>, Document> {
    ... 
    public void load(File... files) {
        this.files = files;
        executeObservable();
    }

    private rx.Observable<SWChannel<List<Document>, Void>> 
    	getRxObservable() {
				return rx.Observable.fromEmitter(
				new SWEmitter<List<Document>, Void>() {
				protected List<Document> doInBackground() 
					throws Exception {
				        ...
				        publish(new Document(...
				        ...
				}
			}, Emitter.BackpressureMode.BUFFER);
	}
	protected void process( List<Document> chunks ){
		fetchResult( chunks );
	}
	...
\end{javacode}
\caption{DocumentLoader - Automatically Refactored Code}
\label{code:example-refactored}
\end{sourcecode}
\end{minipage}
\end{figure}